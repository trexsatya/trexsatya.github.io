{"name":"Analyze Logs With ELK","id":93,"content":"<p>ELK is good alternative to Splunk for small enterprises. Splunk has lot of features, but its expensive. With ELK you can customize anything.</p>\n\n<p>ElasticSearch exposes a REST API, using which you can create,update, delete indexes, and templates. Also search using REST API.</p>\n\n<p>Elasticsearch can be setup as a cluster.</p>\n\n<p>&nbsp;</p>\n\n<p>Logstash can pick log inputs from many different types of sources (50+).&nbsp;</p>\n\n<p>Logstash has filters which can be used to create, modify log events.</p>\n\n<h2>Typical Installation</h2>\n\n<p>Install ElasticSearch, Logstash and Kibana after downloading.</p>\n\n<ul>\n\t<li><strong>Logstash</strong>: The server component of Logstash that processes incoming logs</li>\n\t<li><strong>Elasticsearch</strong>: Stores all of the logs</li>\n\t<li><strong>Kibana</strong>: Web interface for searching and visualizing logs, which will be proxied through Nginx</li>\n</ul>\n\n<p>ElasticSearch needs Java to run.</p>\n\n<p>Run these three components using commands in their bin folders.</p>\n\n<p>Use Kibana to see the logs and visualize the data (basic analytics on logs)</p>\n\n<p>Following is a sample config file, to watch logs in a folder/file.</p>\n\n<pre>\n<code class=\"language-javascript\">input{\n  file{\n    path =&gt; \"folder or file\"\n    start_position =&gt; \"beginning\"\n    type =&gt; \"legal\"\n    codec =&gt; multiline {\n        pattern =&gt; \"(^\\s)|(^Caused by:)\"\n        what =&gt; \"previous\"\n    } \n  }\n}\n\nfilter{\n  grok {\n      match =&gt; [ \"message\", \"%{TIMESTAMP_ISO8601:datetime}\\s+%{LOGLEVEL:loglevel}\\s+ \\[%{DATA:logger}\\]\\s+%{GREEDYDATA:restOfMessage}\" ]\n      \n      match =&gt; [ \"message\", \"%{TIME:time}\\s+\\[%{DATA:thread}\\]\\s+%{LOGLEVEL:loglevel}\\s+%{DATA:logger}\\s+-\\s+%{GREEDYDATA:restOfMessage}\"]\n      \n      match =&gt; [\"message\", \"%{DATA:exception}Exception:%{GREEDYDATA:restOfMessage}\"]\n  }\n}\n\noutput {\n  stdout { codec =&gt; rubydebug }\n  \n  file {\n        codec =&gt; rubydebug\n        path =&gt; \"filepath\"\n  }\n  \n  elasticsearch {\n    hosts =&gt; [\"localhost:9200\"]\n    sniffing =&gt; true\n    manage_template =&gt; false\n    index =&gt; \"logstash-enab-%{type}-%{+YYYY.MM.dd}\"\n    \n  }\n}</code></pre>\n\n<p>&nbsp;</p>\n","authorId":null,"subject":"devops","tags":["basic"],"img":"/images/kibana.jpg","summary":null,"lastUpdated":null}